<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Links Network demo</title>

        <style>
            div {font: 10pt arial;

                 background-image:url('../img/unnamed.png');
                 background-size: 100% 100%;
            }


            /*   position:absolute;
                      content:"";
                      opacity: 0.6;
                      filter: alpha(opacity=40);
            */       
        </style>

        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script type="text/javascript" src="../dist/network.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
        <script type="text/javascript">

            var nodesTable = null;
            var linksTable = null;
            var network = null;
            var options = null;

            var DIR = '../img/';
            var moveX = -300;
            var moveY = -100;


            //google.load(API_name, version)
            google.load('visualization', '1');//?

            // Set callback to run when API is loaded  `
            google.setOnLoadCallback(drawVisualization);//?


            function drawVisualization() {

                //use the 'google.visualization' API's DataTable() 
                //make the Matrix(including column and row)
                nodesTable = new google.visualization.DataTable();
                linksTable = new google.visualization.DataTable();

                //when you add the column, Column goes orderly
                nodesTable.addColumn('number', 'id');
                nodesTable.addColumn('string', 'text');
                nodesTable.addColumn('string', 'image');
                nodesTable.addColumn('string', 'style');
                nodesTable.addColumn('number', 'x');
                nodesTable.addColumn('number', 'y');



                //when you add the row, Row goes orderly
                nodesTable.addRow([1, 'KOREN', DIR + 'cloud.PNG', 'image', 550 + moveX, 350 + moveY]);
//////////////////Type-O 

                nodesTable.addRow([2, 'TYPE O - KU', DIR + 'TYPEO-hard.PNG', 'image', 300 + moveX, 350 + moveY]);
                nodesTable.addRow([3, 'TYPE O - GIST', DIR + 'TYPEO-hard.PNG', 'image', 500 + moveX, 500 + moveY]);
                nodesTable.addRow([4, 'TYPE O - JNU', DIR + 'TYPEO-hard.PNG', 'image', 780 + moveX, 400 + moveY]);
                nodesTable.addRow([6, 'GIST', DIR + 'university.png', 'image', 450 + moveX, 650 + moveY]);


/////////////
/////////////
                nodesTable.addRow([8, 'KU_Phone', DIR + 'Iphone.PNG', 'image', 200 + moveX, 360 + moveY]);
                nodesTable.addRow([9, 'JNU_video', DIR + 'video.PNG', 'image', 990 + moveX, 400 + moveY]);
                nodesTable.addRow([10, 'JNU_Drone', DIR + 'drone.PNG', 'image', 950 + moveX, 300 + moveY]);


///////////////JNU_DORNE_SENSOR
                nodesTable.addRow([14, 'DRONE_TEMP', DIR + 'sensor.png', 'image', 900 + moveX, 150 + moveY]);
                nodesTable.addRow([15, 'DRONE_HUMID', DIR + 'sensor.png', 'image', 980 + moveX, 120 + moveY]);
                nodesTable.addRow([16, 'DRONE_LIGHT', DIR + 'sensor.png', 'image', 1060 + moveX, 150 + moveY]);
                nodesTable.addRow([20, 'DRONE_AIRQUALITY', DIR + 'sensor.png', 'image', 1100 + moveX, 210 + moveY]);
                nodesTable.addRow([26, 'DRONE_GPS', DIR + 'sensor.png', 'image', 1100 + moveX, 270 + moveY]);

                ///////////JNU_Rasp_SenSor
                nodesTable.addRow([21, 'Raspberry Pi', DIR + 'Raspberry.png', 'image', 950 + moveX, 520 + moveY]);
                nodesTable.addRow([22, 'RASP_TEMP', DIR + 'sensor.png', 'image', 900 + moveX, 650 + moveY]);
                nodesTable.addRow([23, 'RASP_HUMID', DIR + 'sensor.png', 'image', 980 + moveX, 680 + moveY]);
                nodesTable.addRow([24, 'RASP_LIGHT', DIR + 'sensor.png', 'image', 1060 + moveX, 650 + moveY]);
                nodesTable.addRow([25, 'RASP_AIRQUALITY', DIR + 'sensor.png', 'image', 1100 + moveX, 590 + moveY]);
                nodesTable.addRow([27, 'RASP_GPS', DIR + 'sensor.png', 'image', 1100 + moveX, 520 + moveY]);

///////////DEMO_PHONE,DRONE
                nodesTable.addRow([17, 'TYPE 0 - DEMO', DIR + 'TYPEO-hard.PNG', 'image', 500 + moveX, 170 + moveY]);
                nodesTable.addRow([18, 'Demo Drone', DIR + 'drone.PNG', 'image', 400 + moveX, 20 + moveY]);
                nodesTable.addRow([19, 'Demo Phone', DIR + 'Iphone.PNG', 'image', 580 + moveX, 20 + moveY]);

/////////////KU
                nodesTable.addRow([11, 'KU_Sensor1', DIR + 'sensor.png', 'image', 90 + moveX, 280 + moveY]);
                nodesTable.addRow([12, 'KU_Sensor2', DIR + 'sensor.png', 'image', 80 + moveX, 380 + moveY]);
                nodesTable.addRow([13, 'KU_Video', DIR + 'video.PNG', 'image', 108 + moveX, 470 + moveY]);


//////////////////////안 쓰는 sensor 추가부분. 50번대////
////////////Demo Drone_sensor
                nodesTable.addRow([51, 'DRONE_TEMP', DIR + 'sensor.png', 'image', 240 + moveX, moveY - 70]);

                nodesTable.addRow([52, 'DRONE_HUMID', DIR + 'sensor.png', 'image', 320 + moveX, moveY - 100]);

                nodesTable.addRow([53, 'DRONE_LIGHT', DIR + 'sensor.png', 'image', 400 + moveX, moveY - 130]);

                nodesTable.addRow([54, 'DRONE_AIRQUALITY', DIR + 'sensor.png', 'image', 480 + moveX, moveY - 110]);

                nodesTable.addRow([55, 'DRONE_GPS', DIR + 'sensor.png', 'image', 550 + moveX, moveY - 80]);

                nodesTable.addRow([56, 'demo_Sensor1', DIR + 'sensor.png', 'image', 680 + moveX, moveY-70]);
                nodesTable.addRow([57, 'demo_Sensor2', DIR + 'sensor.png', 'image', 750 + moveX, moveY-30]);
				nodesTable.addRow([58, 'demo_Video', DIR + 'video.PNG', 'image', 240 + moveX, 70 + moveY]);


/////////////////////////////////linkstable
                linksTable.addColumn('number', 'from');
                linksTable.addColumn('number', 'to');
                linksTable.addColumn('number', 'id');
                linksTable.addColumn('string', 'style');
                linksTable.addColumn('string', 'color');


                linksTable.addRow([2, 1, 1, 'line', undefined]);
                linksTable.addRow([3, 1, 2, 'line', undefined]);
                linksTable.addRow([4, 1, 3, 'line', undefined]);
                linksTable.addRow([6, 3, 5, 'line', undefined]);
                linksTable.addRow([8, 2, 7, 'line', undefined]);
                linksTable.addRow([9, 10, 8, 'line', undefined]);
                linksTable.addRow([10, 4, 9, 'line', undefined]);
                linksTable.addRow([11, 8, 10, 'line', undefined]);
                linksTable.addRow([12, 8, 11, 'line', undefined]);
                linksTable.addRow([13, 8, 12, 'line', undefined]);
                linksTable.addRow([14, 10, 13, 'line', undefined]);
                linksTable.addRow([15, 10, 14, 'line', undefined]);
                linksTable.addRow([16, 10, 15, 'line', undefined]);


                //KOREN - DEMO SITE
                linksTable.addRow([17, 1, 16, 'line', undefined]);
                linksTable.addRow([18, 17, 17, 'line', undefined]);
                linksTable.addRow([19, 17, 18, 'line', undefined]);


                linksTable.addRow([20, 10, 19, 'line', undefined]);

                linksTable.addRow([21, 4, 20, 'line', undefined]);

                linksTable.addRow([22, 21, 21, 'line', undefined]);
                linksTable.addRow([23, 21, 22, 'line', undefined]);
                linksTable.addRow([24, 21, 23, 'line', undefined]);
                linksTable.addRow([25, 21, 24, 'line', undefined]);

                linksTable.addRow([26, 10, 25, 'line', undefined]);
                linksTable.addRow([27, 21, 26, 'line', undefined]);




                //////////////////////안 쓰는 sensor 추가부분.
                linksTable.addRow([51, 18, 26, 'line', undefined]);
                linksTable.addRow([52, 18, 27, 'line', undefined]);
                linksTable.addRow([53, 18, 28, 'line', undefined]);
                linksTable.addRow([54, 18, 29, 'line', undefined]);
                linksTable.addRow([55, 18, 30, 'line', undefined]);
				linksTable.addRow([56, 19, 31, 'line', undefined]);
                linksTable.addRow([57, 19, 32, 'line', undefined]);
				linksTable.addRow([58, 18, 33, 'line', undefined]);


                //node random position
                //randoms x,y variable



                //nodesTable.setCell(0, 4, cx);
                //nodesTable.setCell(0, 5, cy);


                // specify options

                options = {
                    //adjust the frame size 
                    'width': '1500px',
                    'height': '800px',
                    //  'stabilize': true;
                    'links': {
                        'width': 2.5
                    }


                };
                // network ID 
                network = new links.Network(document.getElementById('mynetwork'));

                network.draw(nodesTable, linksTable, options);//draw the network topology

                //set the canvas size
                network._setSize("100%", "100%");

            }



 	$(function () {
                // socket.io 서버에 접속한다
                var socket = io();
                socket.emit("init", {
                    connect: 'on'
                });
                // 서버로부터의 메시지가 수신되면
		socket.on("rasp", function(data) {
      		  console.log(data);
      		    if(data == null) {
			linksTable.setCell(2, 3, 'line');
        linksTable.setCell(2, 4, 'black');
        linksTable.setCell(5, 3, 'line');
        linksTable.setCell(5, 4, 'black');
        linksTable.setCell(7, 3, 'line');
        linksTable.setCell(7, 4, 'black');
        linksTable.setCell(8, 3, 'line');
        linksTable.setCell(8, 4, 'black');
        linksTable.setCell(12, 3, 'line');
        linksTable.setCell(12, 4, 'black');
        linksTable.setCell(13, 3, 'line');
        linksTable.setCell(13, 4, 'black');
        network.draw(nodesTable, linksTable, options);
      } else {
	linksTable.setCell(2, 3, 'moving-arrows');
        linksTable.setCell(2, 4, 'blue');
        linksTable.setCell(5, 3, 'moving-arrows');
        linksTable.setCell(5, 4, 'blue');
        linksTable.setCell(7, 3, 'moving-arrows');
        linksTable.setCell(7, 4, 'blue');
        linksTable.setCell(8, 3, 'moving-arrows');
        linksTable.setCell(8, 4, 'blue');
        linksTable.setCell(12, 3, 'moving-arrows');
        linksTable.setCell(12, 4, 'blue');
        linksTable.setCell(13, 3, 'moving-arrows');
        linksTable.setCell(13, 4, 'blue');
        network.draw(nodesTable, linksTable, options);
      }   
   		 });
		
                socket.on("rasp2", function (data) {
                    console.log(data);

                    if (data == null) {
                    } else {


                        if (data.temp != "null") {
                            linksTable.setCell(20, 3, 'moving-arrows');
                        }
                        if (data.humidity != "null") {
                            linksTable.setCell(21, 3, 'moving-arrows');

                        }
                        if (data.light !="null") {
                            linksTable.setCell(22, 3, 'moving-arrows');

                        }

                        if (data.ratio != "null" && data.concentration != "null" && data.lowpulseoccupancy != "null") {
                            linksTable.setCell(23, 3, 'moving-arrows');

                        }
                        if (data.latitude != "null" && data.logitude != "null") {
                            linksTable.setCell(25, 3, 'moving-arrows');

                        }
                        
                        network.draw(nodesTable, linksTable, options);
                    }

                }); 

           }); 


            /** setCell(Table_row, Table_column, constant)
             * **/

        </script>

    </head>

    <body>
        <!--<h3 style="text-align:center">[Smart Air IoT-Cloud Demo Visualization]</h3>-->



        <div id="mynetwork" ></div>



    </body>

</html>
